# 设备脚本

## 1.概述

### 1.1 设计目的

程序运行在一个可编程键盘上，可以用脚本实现一些操作，包括但不限于：
- 执行包括键盘、鼠标在内的一系列的自动化操作
- 控制 LED 灯光效果
- 更复杂的操作（判断跳转、循环等）

### 1.2 架构特性  

- 指令长度不固定
- 每个按键有 4 个 8 位可选参数。按键动作可以触发脚本，并同时传递4个参数。如果没有使用，参数也可以作为通用寄存器使用
- 16 个 32 位通用寄存器（每个线程独立，可作为指针间接寻址）
- 至少 4 个全局寄存器（线程之间共享访问）
- 支持多线程

### 1.3 内核说明  

- 单个程序代码空间 4KB（不绝对，少数设备可能只有 256B 或 64KB）
- 脚本的RAM空间有限，最少可能只有128B，尽量使用寄存器暂存数据。

<details>
<summary>寄存器列表</summary>  

| 名称               | 位宽 | 读写 | 说明                                                                                        |
|------------------|----|----|-------------------------------------------------------------------------------------------|
| V0               | 8  | RW | 按键传入的参数/通用寄存器                                                                             |
| V1               | 8  | RW | 按键传入的参数/通用寄存器                                                                             |
| V2               | 8  | RW | 按键传入的参数/通用寄存器                                                                             |
| V3               | 8  | RW | 按键传入的参数/通用寄存器                                                                             |
| R0               | 32 | RW | 通用寄存器                                                                                     |
| R1               | 32 | RW | 通用寄存器                                                                                     |
| R2               | 32 | RW | 通用寄存器                                                                                     |
| R3               | 32 | RW | 通用寄存器                                                                                     |
| *DPTR            | 8  | R  | ROM寻址专用寄存器，映射到 R4，共享地址空间                                                                  |
| DPTR             | 32 | RW | 映射到 R4                                                                                    |
| KEY_IO           | 8  | R  | 0=pressed                                                                                 |
| *R0              | 8  | RW | 使用R0寻址RAM                                                                                 |
| *R1              | 8  | RW | 使用R1寻址RAM                                                                                 |
| *R2              | 8  | RW | 使用R2寻址RAM                                                                                 |
| *R3              | 8  | RW | 使用R3寻址RAM                                                                                 |
| ZERO             | 8  | R  | 读取恒为0                                                                                     |
| A                | 32 | RW | 专用寄存器。映射到R6，共享地址空间。某些指令可以用此寄存器可以减少代码长度                                                    |
| B                | 32 | RW | 专用寄存器。映射到R7，共享地址空间。某些指令可以用此寄存器可以减少代码长度                                                    |
| SYS_TIME_MS      | 16 | R  | 系统时间，毫秒。取值范围0~999                                                                         |
| SYS_TIME_S       | 32 | R  | 系统时间，秒。                                                                                   |
| SYS_KBLED        | 8  | RW | 键盘 LED 状态（Num Lock、Caps Lock、Scroll Lock等）。R：读取当前状态。 W：修改状态(自动发送键盘按键)。需要连续操作 2 次，以保证按键释放。 |
| SYS_KEY_COUNT    | 32 | R  | 系统物理按键次数计数                                                                                |
| SYS_KEY_LAY      | 8  | RW | 键盘层级。一个键盘可能有多层按键设置                                                                        |
| SCRIPT_ADDR      | 32 | R  | 脚本起始地址                                                                                    |
| RANDOM           | 32 | RW | R:获取随机数 W:设置随机数种子                                                                         |
| SYS_BLE_NUM      | 8  | RW | 蓝牙多机切换                                                                                    |
| SYS_VOLUME       | 8  | RW | 绝对系统音量；因windows系统无效目前无作用                                                                  |
| SELECTED_LED     | 8  | RW | 选中操作的LED灯。默认选中执行按键本身的LED                                                                  |
| SELECTED_LED_COL | 24 | RW | 修改选中灯的灯光颜色（RGB888）                                                                        |
| ALL_LED_COL      | 24 | RW | 修改全部灯的灯光颜色（RGB888）                                                                        |
| CFG_ADDR         | 32 | R  | 获取当前配置文件地址                                                                                |
| HE_KEY_LV        | 32 | RW | 磁轴的按键深度数值，单位um。R: 获取当前按键 W: 获取目标按键，数值会被压栈，使用POP指令弹出即可                                     |
| R4               | 32 | RW | 通用寄存器                                                                                     |
| R5               | 32 | RW | 通用寄存器                                                                                     |
| R6               | 32 | RW | 通用寄存器                                                                                     |
| R7               | 32 | RW | 通用寄存器                                                                                     |
| R8               | 32 | RW | 通用寄存器                                                                                     |
| R9               | 32 | RW | 通用寄存器                                                                                     |
| R10              | 32 | RW | 通用寄存器                                                                                     |
| R11              | 32 | RW | 通用寄存器                                                                                     |
| R12              | 32 | RW | 通用寄存器                                                                                     |
| R13              | 32 | RW | 通用寄存器                                                                                     |
| R14              | 32 | RW | 通用寄存器                                                                                     |
| R15              | 32 | RW | 通用寄存器                                                                                     |
| *R4              | 8  | RW | 使用R4寻址RAM                                                                                 |
| *R5              | 8  | RW | 使用R5寻址RAM                                                                                 |
| *R6              | 8  | RW | 使用R6寻址RAM                                                                                 |
| *R7              | 8  | RW | 使用R7寻址RAM                                                                                 |
| *R0_16b          | 16 | RW |                                                                                           |
| *R1_16b          | 16 | RW |                                                                                           |
| *R2_16b          | 16 | RW |                                                                                           |
| *R3_16b          | 16 | RW |                                                                                           |
| *R4_16b          | 16 | RW |                                                                                           |
| *R5_16b          | 16 | RW |                                                                                           |
| *R6_16b          | 16 | RW |                                                                                           |
| *R7_16b          | 16 | RW |                                                                                           |
| *R0_32b          | 32 | RW |                                                                                           |
| *R1_32b          | 32 | RW |                                                                                           |
| *R2_32b          | 32 | RW |                                                                                           |
| *R3_32b          | 32 | RW |                                                                                           |
| *R4_32b          | 32 | RW |                                                                                           |
| *R5_32b          | 32 | RW |                                                                                           |
| *R6_32b          | 32 | RW |                                                                                           |
| *R7_32b          | 32 | RW |                                                                                           |
| GL_SIZE          |    |    | 有多少个GL寄存器(至少有4个，最多有64个)                                                                   |
| GL_0             | 32 |    | 通用全局寄存器                                                                                   |
| GL_1             | 32 |    | 通用全局寄存器                                                                                   |
| GL_2             | 32 |    | 通用全局寄存器                                                                                   |
| GL_3             | 32 |    | 通用全局寄存器                                                                                   |
| ...              | 32 |    | 通用全局寄存器                                                                                   |

</details>

### 1.4 脚本的执行  
- 一般情况下，键盘按键作为脚本的开关，按下按键即可执行对应的脚本。  
- 执行脚本的同时，按键设置的4个可选参数将被传入脚本的寄存器。  
- 脚本的执行顺序是从上至下，顺序执行，并进行对应指令的操作。  
- 脚本会一直不停执行，直到**延时**、**等待**或**退出**指令。  
- 脚本运行后默认处于开关模式（按一下开始执行，再按一下强制结束并释放按键），如果要判断双击操作请先进入点动模式

### 1.5 发送按键操作  
- 输出基本的按键操作到主机（一般是PC）  
- 如果有发送按键操作，需延时等待后再释放，否则主机收不到按键操作。  
- 最基本的 4 个步骤： 按下、延时、释放、延时（如果延时的下一条指令是退出可以省略延时）。  
- 延时单位是毫秒，1 秒=1000 毫秒。  
- 延时至少 1 毫秒，建议至少 5 毫秒。太快的话主机会收不到或处理不过来。  
- 一般人按键在 30 毫秒以上，建议值默认值35。  
- 两次按键操作之间必须加延时  
- 支持发送按下和释放，支持嵌套（同时按下多个键）
- 退出脚本前必须释放按键，否则按键会一直保持按下状态！！！  

### 2. 指令结构

```  
[操作码] [操作数1] [操作数2] [操作数3]  
```  
- 操作码固定为 8bit  
- 指令长度可变。最短 1 字节，最长 6 字节  
- 操作数有零个或多个，可以是寄存器或立即数，具体看指令说明  
- 除特殊说明外，数据均为小端  
- 每个操作数至少1字节。其中寄存器1字节，16位立即数2字节，24位立即数3字节，32位立即数4字节  
- 操作数类型
```   
label 标签,跳转用（或无符号16位大端立即数）   
i8 有符号8位小端立即数  
u8 无符号8位小端立即数  
i16 有符号16位小端立即数  
u16 无符号16位小端立即数  
i32 有符号32位小端立即数  
u32 无符号32位小端立即数  
reg 寄存器  
RGB888 24位颜色数据  
```   

## 3.指令列表   
<details>
<summary>全部指令</summary>  

| 助记符               | 操作码 | 操作码（HEX） | 指令长度 | 操作数 i  | 操作数 j | 操作数 k | 作用                                         | 备注                                                                                                |
|-------------------|-----|----------|------|--------|-------|-------|--------------------------------------------|---------------------------------------------------------------------------------------------------|
| END               | 0   | 0x0      | 1    | -      | -     | -     | 程序结束                                       |                                                                                                   |
| NOP               | 1   | 0x1      | 1    | -      | -     | -     | 空操作                                        |                                                                                                   |
| JMP               | 2   | 0x2      | 3    | label  | -     | -     | PC = i;                                    | 长跳转                                                                                               |
| SJMP              | 3   | 0x3      | 2    | i8     | -     | -     | PC = PC + i;                               | 短跳转，偏移量                                                                                           |
| AJMP              | 4   | 0x4      | 2    | u8     | -     | -     | PC = (PC & 0xff00) + i;                    | 在地址的256B范围内跳转                                                                                     |
| SLEEP_X256        | 5   | 0x5      | 2    | u8     | -     | -     | Sleep(i * 256);                            | 延时范围0-65280ms（256倍率）                                                                              |
| SLEEP             | 6   | 0x6      | 2    | u8     | -     | -     | Sleep(i * 1);                              | 延时范围0-255ms                                                                                       |
| SLEEP_RAND_X256   | 7   | 0x7      | 2    | u8     | -     | -     | Sleep(rand()%(i * 256)+1);                 | 随机延时范围1-65281ms（256倍率）                                                                            |
| SLEEP_RAND        | 8   | 0x8      | 2    | u8     | -     | -     | Sleep(rand()%i+1);                         | 随机延时范围1-256ms                                                                                     |
| SLEEP_X256_VAL    | 9   | 0x9      | 2    | reg    | -     | -     | Sleep(i * 256);                            | 延时的寄存器版本，范围取决于寄存器（256倍率）                                                                          |
| SLEEP_VAL         | 10  | 0x0A     | 2    | reg    | -     | -     | Sleep(i);                                  | 延时的寄存器版本，范围取决于寄存器                                                                                 |
| SLEEP_RAND_X8_VAL | 11  | 0x0B     | 2    | reg    | -     | -     | Sleep(rand()%(i * 8)+1);                   | 随机延时的寄存器版本，范围取决于寄存器（8倍率）                                                                          |
| SLEEP_RAND_VAL    | 12  | 0x0C     | 2    | reg    | -     | -     | Sleep(rand()%i+1);                         | 随机延时的寄存器版本，范围取决于寄存器                                                                               |
| SLEEP_U16         | 13  | 0x0D     | 3    | u16    | -     | -     | Sleep(i);                                  | 延时范围1-65536ms                                                                                     |
| SLEEP_RAND_U16    | 14  | 0x0E     | 3    | u16    | -     | -     | Sleep(rand()%i+1);                         | 延时范围1-65536ms                                                                                     |
| PRESS_SK          | 16  | 0x10     | 2    | u8     | -     | -     | 键盘 修饰键 i 按下                                | HID键码                                                                                             |
| PRESS_GK          | 17  | 0x11     | 2    | u8     | -     | -     | 键盘 普通键 i 按下                                | HID键码                                                                                             |
| PRESS_MK          | 18  | 0x12     | 2    | u8     | -     | -     | 鼠标 鼠标键 i 按下                                | HID键码                                                                                             |
| PRESS_MU          | 19  | 0x13     | 2    | u8     | -     | -     | 按键 多媒体 i 按下                                | HID键码                                                                                             |
| PRESS_SK_VAL      | 20  | 0x14     | 2    | reg    | -     | -     | 键盘 修饰键 i 按下                                | HID键码                                                                                             |
| PRESS_GK_VAL      | 21  | 0x15     | 2    | reg    | -     | -     | 键盘 普通键 i 按下                                | HID键码                                                                                             |
| PRESS_MK_VAL      | 22  | 0x16     | 2    | reg    | -     | -     | 鼠标 鼠标键 i 按下                                | HID键码                                                                                             |
| PRESS_MU_VAL      | 23  | 0x17     | 2    | reg    | -     | -     | 按键 多媒体 i 按下                                | HID键码                                                                                             |
| RELEASE_SK        | 24  | 0x18     | 2    | u8     | -     | -     | 键盘 修饰键 i 释放                                | HID键码                                                                                             |
| RELEASE_GK        | 25  | 0x19     | 2    | u8     | -     | -     | 键盘 普通键 i 释放                                | HID键码                                                                                             |
| RELEASE_MK        | 26  | 0x1A     | 2    | u8     | -     | -     | 鼠标 鼠标键 i 释放                                | HID键码                                                                                             |
| RELEASE_MU        | 27  | 0x1B     | 2    | u8     | -     | -     | 按键 多媒体 i 释放                                | HID键码                                                                                             |
| RELEASE_SK_VAL    | 28  | 0x1C     | 2    | reg    | -     | -     | 键盘 修饰键 i 释放                                | HID键码                                                                                             |
| RELEASE_GK_VAL    | 29  | 0x1D     | 2    | reg    | -     | -     | 键盘 普通键 i 释放                                | HID键码                                                                                             |
| RELEASE_MK_VAL    | 30  | 0x1E     | 2    | reg    | -     | -     | 鼠标 鼠标键 i 释放                                | HID键码                                                                                             |
| RELEASE_MU_VAL    | 31  | 0x1F     | 2    | reg    | -     | -     | 按键 多媒体 i 释放                                | HID键码                                                                                             |
| UPDATE            | 32  | 0x20     | 1    | -      | -     | -     | HID数据包强制重传(一般不会使用)                         |                                                                                                   |
| MO_XYZ            | 33  | 0x21     | 3    | u8     | i8    | -     | 鼠标 光标移动 axis=i data=j                      | 0: x, 1:y, 2:scroll                                                                               |
| MO_XYZ_VAL        | 34  | 0x22     | 3    | u8     | reg   | -     | 鼠标 光标移动 axis=i data=j                      |                                                                                                   |
| GA_XYZ            | 35  | 0x23     | 4    | u8     | u16   | -     | joystick axis=i data=j                     |                                                                                                   |
| GA_XYZ_VAL        | 36  | 0x24     | 3    | u8     | reg   | -     | joystick axis=i data=j                     |                                                                                                   |
| TB_XY             | 37  | 0x25     | 5    | i16    | i16   | -     | 鼠标 光标定位 x=i y=j                            |                                                                                                   |
| TB_XY_VAL         | 38  | 0x26     | 3    | reg    | reg   | -     | 鼠标 光标定位 x=i y=j                            |                                                                                                   |
| DIAL_DATA         | 39  | 0x27     | 2    | u8     | -     | -     | Dial data=i                                | data:0=release 1=press 2=cw 3=ccw                                                                 |
| DIAL_DATA_VAL     | 40  | 0x28     | 2    | reg    | -     | -     | Dial data=i                                | data:0=release 1=press 2=cw 3=ccw                                                                 |
| KEY_TO_AXIS       | 41  | 0x29     | 1    | -      | -     | -     | joystick axis=reg::val[0] type=reg::val[1] | 内部使用                                                                                              |
| PRESS_GAK         | 44  | 0x2C     | 2    | u8     | -     | -     | joystick 按键 i 按下                           |                                                                                                   |
| PRESS_GAK_VAL     | 45  | 0x2D     | 2    | reg    | -     | -     | joystick 按键 i 按下                           |                                                                                                   |
| RELEASE_GAK       | 46  | 0x2E     | 2    | u8     | -     | -     | joystick 按键 i 释放                           |                                                                                                   |
| RELEASE_GAK_VAL   | 47  | 0x2F     | 2    | reg    | -     | -     | joystick 按键 i 释放                           |                                                                                                   |
| C2K               | 48  | 0x30     | 1    | -      | -     | -     | print ascii character                      | 内部使用                                                                                              |
| U2K               | 49  | 0x31     | 1    | -      | -     | -     | print unicode character                    | 内部使用                                                                                              |
| C2K_RAND          | 50  | 0x32     | 1    | -      | -     | -     | print random ascii character               | 内部使用                                                                                              |
| U2K_REG           | 51  | 0x33     | 1    | -      | -     | -     | print value                                | 内部使用，需要循环调用直到输出完毕                                                                                 |
| PRINT_REG         | 52  | 0x34     | 2    | reg    | -     | -     | print value                                | 打印寄存器值，只需要执行一次即可完整输出                                                                              |
| JFA               | 64  | 0x40     | 4    | reg    | reg   | reg   | if (i>j)PC=k;                              | 比较两个寄存器的值(无符号数)，根据结果判断是否跳转，目标地址存储于寄存器                                                             |
| JFB               | 65  | 0x41     | 4    | reg    | reg   | reg   | if (i<j)PC=k;                              | 比较两个寄存器的值(无符号数)，根据结果判断是否跳转，目标地址存储于寄存器                                                             |
| JFG               | 66  | 0x42     | 4    | reg    | reg   | reg   | if (i>j)PC=k;                              | 比较两个寄存器的值(无符号数)，根据结果判断是否跳转，目标地址存储于寄存器                                                             |
| JFL               | 67  | 0x43     | 4    | reg    | reg   | reg   | if (i<j)PC=k;                              | 比较两个寄存器的值(无符号数)，根据结果判断是否跳转，目标地址存储于寄存器                                                             |
| JA                | 68  | 0x44     | 5    | reg    | reg   | label | if (i>j)PC=k;                              | 比较两个寄存器的值(有符号数)，根据结果判断是否跳转，目标地址为label                                                             |
| JB                | 69  | 0x45     | 5    | reg    | reg   | label | if (i<j)PC=k;                              | 比较两个寄存器的值(有符号数)，根据结果判断是否跳转，目标地址为label                                                             |
| JG                | 70  | 0x46     | 5    | reg    | reg   | label | if (i>j)PC=k;                              | 比较两个寄存器的值(有符号数)，根据结果判断是否跳转，目标地址为label                                                             |
| JL                | 71  | 0x47     | 5    | reg    | reg   | label | if (i<j)PC=k;                              | 比较两个寄存器的值(有符号数)，根据结果判断是否跳转，目标地址为label                                                             |
| JFC               | 72  | 0x48     | 2    | reg    | -     | -     | if (CY) PC = i;                            | 如果CY置位，则跳转。目标地址存储于寄存器                                                                             |
| JFNC              | 73  | 0x49     | 2    | reg    | -     | -     | if (!CY) PC = i;                           | 如果CY没有置位，则跳转。目标地址存储于寄存器                                                                           |
| JFZ               | 74  | 0x4A     | 3    | reg    | reg   | -     | if (!i) PC = j;                            | 寄存器为0跳转。目标地址存储于寄存器                                                                                |
| JFNZ              | 75  | 0x4B     | 3    | reg    | -     | -     | if (i) PC = j;                             | 寄存器不为0跳转。目标地址存储于寄存器                                                                               |
| DJFNZ             | 76  | 0x4C     | 3    | reg    | reg   | -     | if (--i) PC = j;                           | 寄存器减1并存回，寄存器不为0跳转。目标地址存储于寄存器                                                                      |
| CJFNE             | 77  | 0x4D     | 4    | reg    | reg   | reg   | if (i != j) {CY = i<j;PC = k}              | 比较两个寄存器并设置CY标识，不相等则跳转。目标地址存储于寄存器                                                                  |
| JC                | 78  | 0x4E     | 3    | label  | -     | -     | if (CY) PC = i;                            | 如果CY置位，则跳转。目标地址为label                                                                             |
| JNC               | 79  | 0x4F     | 3    | label  | -     | -     | if (!CY) PC = i;                           | 如果CY没有置位，则跳转。目标地址为label                                                                           |
| JZ                | 80  | 0x50     | 4    | reg    | label | -     | if (!i) PC = j;                            | 寄存器为0跳转。目标地址为label                                                                                |
| JNZ               | 81  | 0x51     | 4    | reg    | label | -     | if (i) PC = j;                             | 寄存器不为0跳转。目标地址为label                                                                               |
| DJNZ              | 82  | 0x52     | 4    | reg    | label | -     | if (--i) PC = j;                           | 寄存器减1并存回，寄存器不为0跳转。目标地址为label                                                                      |
| CJNE              | 83  | 0x53     | 5    | reg    | reg   | label | if (i != j) {CY = i<j;PC = k}              | 比较两个寄存器并设置CY标识，不相等则跳转。目标地址为label                                                                  |
| CALL              | 84  | 0x54     | 3    | label  | -     | -     | PUSH PC;PC=i;                              | 调用子程序，目标地址为label                                                                                  |
| RET               | 85  | 0x55     | 1    | -      | -     | -     | POP PC;                                    | 子程序返回                                                                                             |
| AND               | 86  | 0x56     | 3    | reg    | reg   | -     | i=i&j;                                     |                                                                                                   |
| AND8              | 87  | 0x57     | 3    | reg    | u8    | -     | i=i&j;                                     |                                                                                                   |
| ADD_A             | 88  | 0x58     | 2    | reg    | -     | -     | A = A + i;                                 |                                                                                                   |
| ADD8_A            | 89  | 0x59     | 2    | u8     | -     | -     | A = A + i;                                 |                                                                                                   |
| SUB_A             | 90  | 0x5A     | 2    | reg    | -     | -     | A = A - i;                                 |                                                                                                   |
| SUB8_A            | 91  | 0x5B     | 2    | u8     | -     | -     | A = A - i;                                 |                                                                                                   |
| OR_A              | 92  | 0x5C     | 2    | reg    | -     | -     | A = A | i;                                 |                                                                                                   |
| OR8_A             | 93  | 0x5D     | 2    | u8     | -     | -     | A = A | i;                                 |                                                                                                   |
| DEC               | 94  | 0x5E     | 2    | reg    | -     | -     | i--;                                       |                                                                                                   |
| INC               | 95  | 0x5F     | 2    | reg    | -     | -     | i++;                                       |                                                                                                   |
| MUL_A             | 96  | 0x60     | 1    | -      | -     | -     | A = A * B;                                 |                                                                                                   |
| DIV_A             | 97  | 0x61     | 1    | -      | -     | -     | A = A / B;B = A % B;                       |                                                                                                   |
| XOR               | 98  | 0x62     | 3    | reg    | reg   | -     | i=i^j;                                     |                                                                                                   |
| XOR8              | 99  | 0x63     | 3    | reg    | u8    | -     | i=i^j;                                     |                                                                                                   |
| SHL               | 100 | 0x64     | 3    | reg    | reg   | -     | i=i<<j;                                    |                                                                                                   |
| SHL8              | 101 | 0x65     | 3    | reg    | u8    | -     | i=i<<j;                                    |                                                                                                   |
| SHR               | 102 | 0x66     | 3    | reg    | reg   | -     | i=i>>j;                                    |                                                                                                   |
| SHR8              | 103 | 0x67     | 3    | reg    | u8    | -     | i=i>>j;                                    |                                                                                                   |
| CLR               | 104 | 0x68     | 2    | reg    | -     | -     | i=0;                                       | 寄存器清理                                                                                             |
| NOT               | 105 | 0x69     | 2    | reg    | -     | -     | i=~i;                                      | 寄存器按位取反                                                                                           |
| XCH               | 106 | 0x6A     | 3    | reg    | reg   | -     | i<==>j;                                    | ij交换                                                                                              |
| CMP               | 107 | 0x6B     | 3    | reg    | reg   | -     | CY=i<j;                                    | 比较两个寄存器并设置CY标识（目前本指令没有的必要）                                                                        |
| PUSH              | 108 | 0x6C     | 2    | reg    | -     | -     |                                            | 压栈                                                                                                |
| POP               | 109 | 0x6D     | 2    | reg    | -     | -     |                                            | 出栈                                                                                                |
| MOV               | 110 | 0x6E     | 3    | reg    | reg   | -     | i=j;                                       |                                                                                                   |
| MOV8              | 111 | 0x6F     | 3    | reg    | u8    | -     | i=j;                                       |                                                                                                   |
| MOV16             | 112 | 0x70     | 4    | reg    | u16   | -     | i=j;                                       |                                                                                                   |
| MOV32             | 113 | 0x71     | 6    | reg    | u32   | -     | i=j;                                       |                                                                                                   |
| ADD               | 114 | 0x72     | 3    | reg    | reg   | -     | i=i+j;                                     |                                                                                                   |
| ADD8              | 115 | 0x73     | 3    | reg    | u8    | -     | i=i+j;                                     |                                                                                                   |
| ADD16             | 116 | 0x74     | 4    | reg    | u16   | -     | i=i+j;                                     |                                                                                                   |
| SUB               | 117 | 0x75     | 3    | reg    | reg   | -     | i=i-j;                                     |                                                                                                   |
| SUB8              | 118 | 0x76     | 3    | reg    | u8    | -     | i=i-j;                                     |                                                                                                   |
| SUB16             | 119 | 0x77     | 4    | reg    | u16   | -     | i=i-j;                                     |                                                                                                   |
| OR                | 120 | 0x78     | 3    | reg    | reg   | -     | i=i|j;                                     |                                                                                                   |
| OR8               | 121 | 0x79     | 3    | reg    | u8    | -     | i=i|j;                                     |                                                                                                   |
| AND16             | 122 | 0x7A     | 4    | reg    | u16   | -     | i=i&j;                                     |                                                                                                   |
| OR16              | 123 | 0x7B     | 4    | reg    | u16   | -     | i=i|j;                                     |                                                                                                   |
| XOR16             | 124 | 0x7C     | 4    | reg    | u16   | -     | i=i^j;                                     |                                                                                                   |
| ADD32             | 125 | 0x7D     | 6    | reg    | u32   | -     | i=i+j;                                     |                                                                                                   |
| SUB32             | 126 | 0x7E     | 6    | reg    | u32   | -     | i=i-j;                                     |                                                                                                   |
| AND32             | 127 | 0x7F     | 6    | reg    | u32   | -     | i=i&j;                                     |                                                                                                   |
| OR32              | 128 | 0x80     | 6    | reg    | u32   | -     | i=i|j;                                     |                                                                                                   |
| XOR32             | 129 | 0x81     | 6    | reg    | u32   | -     | i=i^j;                                     |                                                                                                   |
| ADD_R             | 130 | 0x82     | 4    | reg    | reg   | reg   | i=j+k;                                     |                                                                                                   |
| SUB_R             | 131 | 0x83     | 4    | reg    | reg   | reg   | i=j-k;                                     |                                                                                                   |
| AND_R             | 132 | 0x84     | 4    | reg    | reg   | reg   | i=j&k;                                     |                                                                                                   |
| OR_R              | 133 | 0x85     | 4    | reg    | reg   | reg   | i=j|k;                                     |                                                                                                   |
| XOR_R             | 134 | 0x86     | 4    | reg    | reg   | reg   | i=j^k;                                     |                                                                                                   |
| MUL_R             | 135 | 0x87     | 4    | reg    | reg   | reg   | i=j*k;                                     |                                                                                                   |
| DIV_R             | 136 | 0x88     | 4    | reg    | reg   | reg   | i=j/k;                                     |                                                                                                   |
| MOD_R             | 137 | 0x89     | 4    | reg    | reg   | reg   | i=j%k;                                     |                                                                                                   |
| MOVSX8b           | 138 | 0x8A     | 3    | reg    | reg   | -     | i=j;                                       |                                                                                                   |
| MOVSX16b          | 139 | 0x8B     | 3    | reg    | reg   | -     | i=j;                                       |                                                                                                   |
| MOV8SX            | 140 | 0x8C     | 3    | reg    | u8    | -     | i=j;                                       |                                                                                                   |
| MOV16SX           | 141 | 0x8D     | 4    | reg    | i16   | -     | i=j;                                       |                                                                                                   |
| IMUL_A            | 142 | 0x8E     | 1    | -      | -     | -     | A=A*B;                                     |                                                                                                   |
| IMUL_R            | 143 | 0x8F     | 4    | reg    | reg   | reg   | i=j*k;                                     |                                                                                                   |
| LED_CTRL          | 224 | 0xE0     | 2    | u8     | -     | -     | SELECTED_LED = i;                          | 0xff = release                                                                                    |
| LED_COL           | 225 | 0xE1     | 4    | RGB888 | -     | -     | SELECTED_LED_COL = i;                      |                                                                                                   |
| START             | 226 | 0xE2     | 2    | u8     | -     | -     | Start_key(i-1);                            | 0=all                                                                                             |
| STOP              | 227 | 0xE3     | 2    | u8     | -     | -     | Stop_key(i-1);                             | 0=all                                                                                             |
| SYCON             | 232 | 0xE8     | 2    | u8     | -     | -     |                                            | 系统控制                                                                                              |
| MALLOC            | 240 | 0xF0     | 2    | reg    | -     | -     | i=malloc(i);                               |                                                                                                   |
| FREE              | 241 | 0xF1     | 2    | reg    | -     | -     | i=free(i);                                 |                                                                                                   |
| NEW_THREAD        | 242 | 0xF2     | 4    | u8     | reg   | reg   | i=TH ID;j=addr or keymode;k=V[4]           | i的取值范围0~3，实际占用寄存器R12-R15暂存线程地址；主线程退出子线程也会被强制退出；子线程退出不会自动释放malloc内存，除非主线程退出；子线程里可以继续开子线程，但是不建议套太多层 |
|                   | 243 | 0xF3     | 1    | -      | -     | -     |                                            |                                                                                                   |
| WHILE_UPDATE      | 244 | 0xF4     | 1    | -      | -     | -     | while (update_flag)Sleep(1);               | 等待HID上传数据完成                                                                                       |
| JMP_TO_SCRIPT     | 245 | 0xF5     | 2    | u8     | -     | -     |                                            | 跳转到其他脚本号（寄存器数据保留，但PC会重置）                                                                          |
| MOV_PC2REG        | 246 | 0xF6     | 2    | reg    | -     | -     | i=PC;                                      | 把下一条指令的地址保存到寄存器                                                                                   |
| VALUE_RELOAD      | 247 | 0xF7     | 2    | reg    | -     | -     | i=Reload(reg);                             | 重新加载脚本参数                                                                                          |
| MODE_JOG          | 248 | 0xF8     | 1    | -      | -     | -     |                                            | 进入点动模式（再次按下按键不会被强制打断）                                                                             |
| WAIT_IF_RELEASE   | 249 | 0xF9     | 1    | -      | -     | -     | while (IO) Sleep(1);                       | 如果物理按键是释放状态，等待按下后才会继续执行                                                                           |
| WAIT_IF_PRESS     | 250 | 0xFA     | 1    | -      | -     | -     | while (!IO) Sleep(1);                      | 如果物理按键是按下状态，等待释放后才会继续执行                                                                           |
| EXIT_IF_RELEAS    | 251 | 0xFB     | 1    | -      | -     | -     | if (IO) exit();                            | 如果物理按键是释放的，退出脚本                                                                                   |
| EXIT_IF_PRESS     | 252 | 0xFC     | 1    | -      | -     | -     | if (!IO) exit();                           | 如果物理按键是按下的，退出脚本                                                                                   |
| EXIT_IF_ANYKEY    | 253 | 0xFD     | 1    | -      | -     | -     | if (SYS_KEY_COUNT != n)                    | n=脚本开始执行时保存的按键计数器。脚本执行后，可以用此指令实现按任意键退出                                                            |
| RES               | 254 | 0xFE     | 1    | -      | -     | -     | PC = 0;                                    | 跳转到程序开头，等同于JMP 0                                                                                  |
| EXIT              | 255 | 0xFF     | 1    | -      | -     | -     | exit();                                    | 退出脚本                                                                                              |

</details>

## 4.寻址模式
- 立即数  123
- 寄存器  R0
- 间接寻址  *R0

## 5. 内存与堆栈模型  
- **地址空间**：不确定，需要通过寄存器获取  
- **堆栈方向**：向上增长，自动处理，仅能使用PUSH、POP指令操作  
- **内存对齐**：无需对其  

## 6. 异常处理  
- **无效操作码**：自动终止当前线程并清理资源  
- **寄存器越界**：写入只读寄存器时忽略操作  
- **堆栈溢出**：自动终止当前线程并清理资源  

## 7.HID键值  

<details>

- 键盘 修饰键
```      
    0x01: 'hidkey_L_Ctrl',
    0x02: 'hidkey_L_Shift',
    0x04: 'hidkey_L_Alt',
    0x08: 'hidkey_L_Meta',
    0x10: 'hidkey_R_Ctrl',
    0x20: 'hidkey_R_Shift',
    0x40: 'hidkey_R_Alt',
    0x80: 'hidkey_R_Meta',
```  
- 键盘 普通键
```  
    0x00: 'hidkey_UsbReserved',
    0x01: 'hidkey_UsbErrorRollOver',
    0x02: 'hidkey_UsbPostFail',
    0x03: 'hidkey_UsbErrorUndefined',
    0x04: 'hidkey_A',
    0x05: 'hidkey_B',
    0x06: 'hidkey_C',
    0x07: 'hidkey_D',
    0x08: 'hidkey_E',
    0x09: 'hidkey_F',
    0x0a: 'hidkey_G',
    0x0b: 'hidkey_H',
    0x0c: 'hidkey_I',
    0x0d: 'hidkey_J',
    0x0e: 'hidkey_K',
    0x0f: 'hidkey_L',
    0x10: 'hidkey_M',
    0x11: 'hidkey_N',
    0x12: 'hidkey_O',
    0x13: 'hidkey_P',
    0x14: 'hidkey_Q',
    0x15: 'hidkey_R',
    0x16: 'hidkey_S',
    0x17: 'hidkey_T',
    0x18: 'hidkey_U',
    0x19: 'hidkey_V',
    0x1a: 'hidkey_W',
    0x1b: 'hidkey_X',
    0x1c: 'hidkey_Y',
    0x1d: 'hidkey_Z',
    0x1e: 'hidkey_1',
    0x1f: 'hidkey_2',
    0x20: 'hidkey_3',
    0x21: 'hidkey_4',
    0x22: 'hidkey_5',
    0x23: 'hidkey_6',
    0x24: 'hidkey_7',
    0x25: 'hidkey_8',
    0x26: 'hidkey_9',
    0x27: 'hidkey_0',
    0x28: 'hidkey_Enter',
    0x29: 'hidkey_Escape',
    0x2a: 'hidkey_Backspace',
    0x2b: 'hidkey_Tab',
    0x2c: 'hidkey_Space',
    0x2d: 'hidkey_Minus',
    0x2e: 'hidkey_Equal',
    0x2f: 'hidkey_BracketLeft',
    0x30: 'hidkey_BracketRight',
    0x31: 'hidkey_Backslash',
    0x33: 'hidkey_Semicolon',
    0x34: 'hidkey_Quote',
    0x35: 'hidkey_Backquote',
    0x36: 'hidkey_Comma',
    0x37: 'hidkey_Period',
    0x38: 'hidkey_Slash',
    0x39: 'hidkey_CapsLock',
    0x3a: 'hidkey_F1',
    0x3b: 'hidkey_F2',
    0x3c: 'hidkey_F3',
    0x3d: 'hidkey_F4',
    0x3e: 'hidkey_F5',
    0x3f: 'hidkey_F6',
    0x40: 'hidkey_F7',
    0x41: 'hidkey_F8',
    0x42: 'hidkey_F9',
    0x43: 'hidkey_F10',
    0x44: 'hidkey_F11',
    0x45: 'hidkey_F12',
    0x46: 'hidkey_PrintScreen',
    0x47: 'hidkey_ScrollLock',
    0x48: 'hidkey_Pause',
    0x49: 'hidkey_Insert',
    0x4a: 'hidkey_Home',
    0x4b: 'hidkey_PageUp',
    0x4c: 'hidkey_Delete',
    0x4d: 'hidkey_End',
    0x4e: 'hidkey_PageDown',
    0x4f: 'hidkey_ArrowRight',
    0x50: 'hidkey_ArrowLeft',
    0x51: 'hidkey_ArrowDown',
    0x52: 'hidkey_ArrowUp',
    0x53: 'hidkey_NumLock',
    0x54: 'hidkey_PadDivide',
    0x55: 'hidkey_PadMultiply',
    0x56: 'hidkey_PadSubtract',
    0x57: 'hidkey_PadAdd',
    0x58: 'hidkey_PadEnter',
    0x59: 'hidkey_Pad1',
    0x5a: 'hidkey_Pad2',
    0x5b: 'hidkey_Pad3',
    0x5c: 'hidkey_Pad4',
    0x5d: 'hidkey_Pad5',
    0x5e: 'hidkey_Pad6',
    0x5f: 'hidkey_Pad7',
    0x60: 'hidkey_Pad8',
    0x61: 'hidkey_Pad9',
    0x62: 'hidkey_Pad0',
    0x63: 'hidkey_PadDecimal',
    0x64: 'hidkey_IntlBackslash',
    0x65: 'hidkey_ContextMenu',
    0x66: 'hidkey_Power',
    0x67: 'hidkey_PadEqual',
    0x68: 'hidkey_F13',
    0x69: 'hidkey_F14',
    0x6a: 'hidkey_F15',
    0x6b: 'hidkey_F16',
    0x6c: 'hidkey_F17',
    0x6d: 'hidkey_F18',
    0x6e: 'hidkey_F19',
    0x6f: 'hidkey_F20',
    0x70: 'hidkey_F21',
    0x71: 'hidkey_F22',
    0x72: 'hidkey_F23',
    0x73: 'hidkey_F24',
    0x74: 'hidkey_Open',
    0x75: 'hidkey_Help',
    0x77: 'hidkey_Select',
    0x79: 'hidkey_Again',
    0x7a: 'hidkey_Undo',
    0x7b: 'hidkey_Cut',
    0x7c: 'hidkey_Copy',
    0x7d: 'hidkey_Paste',
    0x7e: 'hidkey_Find',
    0x7f: 'hidkey_AudioVolumeMute',
    0x80: 'hidkey_AudioVolumeUp',
    0x81: 'hidkey_AudioVolumeDown',
    0x85: 'hidkey_NumpadComma',
    0x87: 'hidkey_IntlRo',
    0x88: 'hidkey_KanaMode',
    0x89: 'hidkey_IntlYen',
    0x8a: 'hidkey_Convert',
    0x8b: 'hidkey_NonConvert',
    0x90: 'hidkey_Lang1',
    0x91: 'hidkey_Lang2',
    0x92: 'hidkey_Lang3',
    0x93: 'hidkey_Lang4',
    0x94: 'hidkey_Lang5',
    0x9b: 'hidkey_Abort',
    0xa3: 'hidkey_Props',
    0xb6: 'hidkey_NumpadParenLeft',
    0xb7: 'hidkey_NumpadParenRight',
    0xbb: 'hidkey_NumpadBackspace',
    0xd0: 'hidkey_NumpadMemoryStore',
    0xd1: 'hidkey_NumpadMemoryRecall',
    0xd2: 'hidkey_NumpadMemoryClear',
    0xd3: 'hidkey_NumpadMemoryAdd',
    0xd4: 'hidkey_NumpadMemorySubtract',
    0xd7: 'hidkey_NumpadSignChange',
    0xd8: 'hidkey_NumpadClear',
    0xd9: 'hidkey_NumpadClearEntry',
    0xe0: 'hidkey_ControlLeft',
    0xe1: 'hidkey_ShiftLeft',
    0xe2: 'hidkey_AltLeft',
    0xe3: 'hidkey_MetaLeft',
    0xe4: 'hidkey_ControlRight',
    0xe5: 'hidkey_ShiftRight',
    0xe6: 'hidkey_AltRight',
    0xe7: 'hidkey_MetaRight',
```  
- 鼠标 鼠标键
```  
    0x01: 'hidmouse_0',     //左键
    0x02: 'hidmouse_1',     //右键
    0x04: 'hidmouse_2',     //中键
    0x08: 'hidmouse_3',     //侧键1
    0x10: 'hidmouse_4',     //侧键2
```  
- 按键 多媒体
```  
    01: "hidmedia_BrightnessUp",
    02: "hidmedia_BrightnessDown",
    03: "hidmedia_ToggleCmera",
    04: "hidmedia_BeginScreenCapture",
    05: "hidmedia_OpenGameBar",
    06: "hidmedia_ScreenShot",
    07: "hidmedia_BeginStreaming",
    08: "hidmedia_Mute",
    09: "hidmedia_Bass",
    10: "hidmedia_VolumeUp",
    11: "hidmedia_VolumeDown",
    12: "hidmedia_PlayPause",
    13: "hidmedia_Stop",
    14: "hidmedia_PreviousTrack",
    15: "hidmedia_NextTrack",
    16: "hidmedia_BassUp",
    17: "hidmedia_BassDown",
    18: "hidmedia_TrebleUp",
    19: "hidmedia_TrebleDown",
    20: "hidmedia_MediaSelect",
    21: "hidmedia_Mail",
    22: "hidmedia_Calculator",
    23: "hidmedia_Explorer",
    24: "hidmedia_WWWSearch",
    25: "hidmedia_WWWHome",
    26: "hidmedia_WWWBack",
    27: "hidmedia_WWWForward",
    28: "hidmedia_WWWStop",
    29: "hidmedia_WWWRefresh",
    30: "hidmedia_WWWFavorites",
```  

</details>


## 8. 示例代码  

<details>

- 当按键按下时触发脚本发送A键，等待按键释放后发送B键  
```  
PRESS_GK hidkey_A  
SLEEP 35  
RELEASE_GK hidkey_A  
SLEEP 35  
WAIT_IF_PRESS  
PRESS_GK hidkey_B  
SLEEP 35  
RELEASE_GK hidkey_B  
SLEEP 35  
EXIT  
```  

- 短按发送A键(233毫秒)，长按发送B键  
```  
MOV8 R0 233  
label_timeout:  
SLEEP 1  
JNZ KEY_IO label_shortpress  
DJNZ R0 label_timeout  
label_longpress:  
PRESS_GK hidkey_B  
WAIT_IF_PRESS  
RELEASE_GK hidkey_B  
EXIT  
label_shortpress:  
PRESS_GK hidkey_A  
SLEEP 35  
RELEASE_GK hidkey_A  
EXIT  
```

- 随机输出 65~80之间的随机数（使用HID键值直接发送）
```
MODE_JOG        ;防止输出过程中再次按下按键被打断
MOV8 R1  16
MOD_R R1  RANDOM  R1
ADD8 R1  65     ;计算得到最终需要的数值，存储到R1
MOV A  R1
loc_000e:
MOV8 B  10
DIV_A
INC R2
JNZ A  loc_000e ;循环计算有多少位存储到R2，此时B寄存器保存的余数是最高位可以直接打出一位
loc_0018:       ;以下是按位打出按键操作。
JNZ B  loc_001f
MOV8 B  10      ;如果数值是0,直接加10方便计算(hidkey_0的值是0x27,hidkey_1是0x1e)
loc_001f:
MOV A  B
ADD8_A 29       ;加上(hidkey_1 减 1)的值
PRESS_GK_VAL A
SLEEP 35
RELEASE_GK_VAL A
SLEEP 35        ;到此一位数打出完成
DEC R2          ;待输出位数-1
JZ R2  loc_0044 ;如果没有了就跳转到退出
MOV R0  R2      
MOV A  R1
loc_0038:
MOV8 B  10
DIV_A
DJNZ R0  loc_0038
JZ R0  loc_0018 ;计算出下一位后跳转
loc_0044:
```

- 输出10000以内的质数，中途按下任意键退出（DeepSeek写的）
```
MODE_JOG
PRESS_GK hidkey_2
SLEEP 5
RELEASE_GK hidkey_2
SLEEP 5
PRESS_GK hidkey_Enter
SLEEP 5
RELEASE_GK hidkey_Enter
SLEEP 5
MOV32 R0  2
label_outer:
MOV32 R1  2
MOV R3  R0
DEC R3
label_inner:
MOV A  R0
MOV B  R1
DIV_A
JNZ B  label_not_div  
JMP label_next_num  
label_not_div:
INC R1
CMP R1  R3
JB R1  R3  label_inner
MOV A  R0
CLR R2
label_calc_digits:
MOV8 B  10
DIV_A
INC R2
JNZ A  label_calc_digits
label_output:
JNZ B  label_non_zero
MOV8 B  10
label_non_zero:
MOV A  B
ADD8_A 29
PRESS_GK_VAL A
SLEEP 5
RELEASE_GK_VAL A
SLEEP 5
DEC R2
JZ R2  label_finish_num
MOV R4  R2
MOV A  R0
label_shift:
MOV8 B  10
DIV_A
DJNZ R4  label_shift
JMP label_output
label_finish_num:
PRESS_GK hidkey_Enter
SLEEP 5
RELEASE_GK hidkey_Enter
SLEEP 5
label_next_num:
EXIT_IF_ANYKEY
INC R0
MOV32 R15  10000
JB R0  R15  label_outer
EXIT
```

- 单击输出A键，双击输出B键（间隔150ms）
```
MODE_JOG
WAIT_IF_PRESS
MOV16 A  150
label_timeout:
SLEEP 1
JZ KEY_IO  label_press2
DJNZ A  label_timeout
PRESS_GK hidkey_A
SLEEP 35
RELEASE_GK hidkey_A
EXIT
label_press2:
PRESS_GK hidkey_B
SLEEP 35
RELEASE_GK hidkey_B
EXIT
EXIT
```

- 按下按键后“每隔10秒按一次A，每隔15秒按一次B，且加入随机延时防止游戏检测”，再按一次停止（默认处于开关模式）
```
MOV R0  SYS_TIME_S
loc_0003:
MOV A  SYS_TIME_S
SUB_A R0
MOV8 B  10
DIV_A
JNZ B  loc_001c
PRESS_GK hidkey_A
SLEEP 35
SLEEP_RAND 20
RELEASE_GK hidkey_A
SLEEP 35
SLEEP_RAND 128
loc_001c:
MOV A  SYS_TIME_S
SUB_A R0
MOV8 B  15
DIV_A
JNZ B  loc_0033
PRESS_GK hidkey_B
SLEEP 35
SLEEP_RAND 20
RELEASE_GK hidkey_B
SLEEP 35
loc_0033:
MOV16 A  1000
SUB_A SYS_TIME_MS
SLEEP_VAL A
SLEEP_RAND 128
JMP loc_0003
EXIT
```

- 按下后自动重复按A，释放按键后停止，加入随机延时
```
PRESS_GK hidkey_A
SLEEP 35
SLEEP_RAND 20
RELEASE_GK hidkey_A
SLEEP 35
SLEEP_RAND 20
EXIT_IF_RELEAS
RES
```

- 按下后切换键盘功能层(FN键功能)，释放按键恢复。如果只是单击，发送静音。（长按切层，如果是单击执行其他操作）
```
MOV8 SYS_KEY_LAY  1
WAIT_IF_PRESS
MOV8 SYS_KEY_LAY  0
EXIT_IF_ANYKEY
PRESS_MU hidmedia_Mute
SLEEP 35
RELEASE_MU hidmedia_Mute
EXIT
```

</details>

## 9. 你可以在页面右上角下载此文档，让AI帮你写

## X. 给AI助手的特别说明  
<details>
<summary></summary>  

### X.1 用户表达的一些注意点  

- “一直按”大概率指的是“按下-释放-按下-释放...”而不是“一直按住”。  
- “间隔时长”大概率指的是“两次循环”之间的间隔时长，而不是“两次操作”的时长；间隔时长的大部分都是在等待下一次循环。  
- 如果用户没有说明“按住时长”有要求，则默认为35毫秒；但如果用户有要求随机，那么默认30~60毫秒范围内随机。  
- 如果用户要求随机时间，请在有延时的地方全部添加适量随机；随机时间不需要精确。  

### X.2 设备脚本的运行方式  

- 用户有一个键盘，这个键盘支持编程来实现一系列的操作  
- 键盘上的物理按键是触发脚本的开关（无需考虑按键抖动）  
- 请理解用户描述的是“物理按键”还是“要实现的按键操作”  
- 如果程序内有死循环，请确认是否需要加入任意键退出（需要执行到这条指令才会进行判断）  

### X.3 设备说明  

- 键盘可能有多个按键层（FN层），每个层都可以自定义，用户可能会有切换层级的需求  
- 键盘有很多功能，脚本只是其中一个按键模式，该按键模式可以运行脚本代码  
- 键盘有n个按键（n≥1），m个键盘层(m≥1)  
- 每层的按键都可以自定义，每个定义5字节，包括1字节模式和4*1字节的可选参数。  
- 脚本可以修改名称  
- 脚本名称可以通过特殊字符限定传递的参数类型，使脚本更灵活且可以复用（多个按键绑定同一个脚本，通过不同参数实现不同按键等）  

### X.4 指令说明  

- 某些指令可能没有立即数版本，可以先使用MOV8、MOV16、MOV32指令先加载立即数到寄存器。  
- 有立即数版本的指令，请确认其立即数的范围；如果超出范围请使用寄存器版本的指令。  
- 代码中不使用HID键值（0x04），而是使用文档里的别名（hidkey_A）；多个修饰键可以使用“|”连接  
- RANDOM 寄存器一般只作为读取使用，请不要尝试写入  
- 按键延时建议不低于16ms  
- 随机延时一般不会单独使用，而是配合固定延时一起使用。几个例子：  
```
;随机10-30ms
SLEEP 10
SLEEP_RAND 20
```
```
;随机10-3000ms
SLEEP 10
SLEEP_RAND_U16 2990
```
```
;随机1000-3000ms
SLEEP_U16 1000
SLEEP_RAND_U16 2000
```
- 修饰键和普通键直接也需要加入一个较小的延时，比如16ms，否则某些软件可能不会识别。  
```
PRESS_SK 0x04   ; 按下左Alt  
SLEEP 16  
PRESS_GK 0x2B   ; 按下Tab键  
SLEEP 35  
RELEASE_GK 0x2B ; 释放Tab  
SLEEP 16  
RELEASE_SK 0x04 ; 释放Alt 
```

感谢你为用户提供的帮助！

</details>

